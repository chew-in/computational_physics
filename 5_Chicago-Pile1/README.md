# Chicago-Pile No. 1 (CP-1) Simulation
It’s important to establish some background physics for understanding how a nuclear reactor works.
* Nuclear reaction. A nuclear reaction involves input and output reactants, and obeys the conservation of total mass-energy (i.e. relativistic mass-energy + kinetic energy). The Q-value of a reaction describes if a reaction liberates energy or demands a threshold energy to cause it to happen,
$$Q=\sum KE_{output} - \sum KE_{input} = \left(\sum m_{input} - \sum m_{output}\right) c^2$$
* Fission of Uranium. Neutron-induced uranium is the process underlying many nuclear bombs and reactors, one way of which is the extremely energetic splitting of a $^{235}U$ nucleus into barium and krypton accompanied by the release of three neutrons. The fission energy latent in a small amount of the reactants is enormous. 
* Nuclear reactor. Building a nuclear reactor involves sustaining a neutron-moderated chain reaction, where on average at least one neutron will be liberated per fission event. This is denoted by $k$. 
* Energy spectrum of fission neutrons. When nuclei fission, and typically emit two or three neutrons, these secondary neutrons exhibit a spectrum of kinetic energies, which can be expressed as 
$$P(E)dE \sim \sqrt{E}\exp (-E/\alpha)dE$$
where $\alpha$ is some fitting parameter, and $\alpha \sim 1.29$ MeV for $^{235}U$.
* Fission barrier. Any nucleus (e.g. an isotope of Uranium) can be induced to fission under neutron bombardment, but the difficulty of which is specified by a characteristic fission barrier. The fission barrier for $^{236}U$ is exceeded by the Q-value for the relevant reaction, whereas the fission barrier for  $^{239}U$ is higher than the Q-value for the relevant reaction, and this makes all the difference why  $^{235}U$ is a “fissile” nuclide, while  $^{238}U$ is “fissionable”.
* Critical mass. The critical mass is the amount of fissile material needed for a workable nuclear weapon. If the sample of fissile material is too small, the escape probability is high, hence the reason why there is a minimum size of material needed for all nucleus inside the material to be fissioned. 
* Mean Free Path. Understanding Mean Free Path (MFP) for neutron travel is important for calculating reactor criticality. Suppose we have a thin slab of material of thickness $s$, cross-sectional area $\Sigma$, bombarded by neutrons at a rate of $R_0$ neutrons per unit area per unit time, then the incident neutron flux is per unit time is given by $R_0 \Sigma$.
   - On the nuclei side, let $\rho$ be the density of material, $N_A$ be Avogadro’s number, $A$ be the atomic weight of the material, $\sigma$ be the cross-section for the reaction (representing in unit of area how reactive each nucleus presents itself to the incoming neutrons). Then the number density of nuclei in the material is $n=\frac{\rho N_A}{A}$.
   - The fraction of surface area available for reactions to occur is the total number of nuclei (i.e. volume $\Sigma s$ times density $n$) times the fraction of surface area for the particular reaction to occur $\Sigma sn(\sigma/\Sigma) =sn\sigma$.
   - Thus, the rate of reactions $R$ is the product of incident neutron flux times the fraction of surface area available for reactions, $R=(R_0 \Sigma)(sn\sigma)$.
   - For an individual incident neutron, the probability of it participating in a reaction is $P_{react} = sn \sigma$, and the probability of it escaping the slab is $P_{escape} = 1- P_{react} = 1-sn \sigma$.
   - For a block of material of thickness $L$, calculus can be used to figure out the probability of an incident neutron escaping the whole block, as follows. The number of slabs is therefore $L/s$. The probability of an incident neutron escaping the whole block is the product of it escaping each slab, $P_{escape}=(1-sn\sigma)^{L/s}$.
   - Since each slab can be made infinitesimally thin, define $z=-sn\sigma$, then 
   $$P_{escape}=(1+z)^{\sigma nL/z} = [(1+z)^{1/z}]^{-\sigma nL} \rightarrow e^{-\sigma nL}$$
   - A useful parameter is the mean free path or characteristic length for the reaction, which is defined as the average distance a neutron will travel before undergoing a reaction. This can be calculated as averaging the number of neutrons $dN_x$ that penetrate to distance $x$ and $x+dx$ over all possible travel distances. Assume $N_0$ neutrons are incident at the $x=0$ surface, then the number of neutrons consumed $dN_x$ between $x$ and $x+dx$ is
   $$dN_x = N_0 e^{-\sigma nx}(\sigma ndx)$$
   - The mean free path $\lambda_s$ is,
   $$\lambda_s = \frac{1}{N_{react}}\int_0^L xdN_x =\frac{1}{N_0 (1-e^{-\sigma nL})} \int_0^L (N_0\sigma n)x e^{-\sigma nx}dx =\frac{1}{\sigma n} \frac{1-e^{\sigma nL}(1+\sigma nL)}{1-e^{\sigma nL}}$$
   - For thick slab, $\sigma nL$ is large, then 
   $$\lambda_s \rightarrow \frac{1}{\sigma n}$$
* Slow neutron. Fermi discovered accidentally that if the bombarding neutrons were caused to be slowed (“moderated”) before hitting the target element, the rate of the induced radioactivities could be drastically increased. When a nucleus is struck by a neutron, one of three things will in general happen: (1) The nucleus may fission $(f)$; (2) The nucleus may capture the neutron without fissioning $(c)$; or (3) The neutron may scatter from the nucleus. For example, the fissility parameter for fast neuron with $^{235}U$ is $1.235$, whereas the fissility parameter for slow neuron with $^{235}U$ is $584.4$. Note that even though slow neutrons are extremely useful for maximizing criticality for reactors, they are not applicable for nuclear bombs as the key metric there is the energy released, which goes as the inverse square of the reaction time.
* Reactor criticality. Reactor criticality factor, denoted by $k$, is the key figure of merit in whether ($k \geq 1$) or not ($k < 1$) a reactor can achieve a self-sustaining chain reaction. An ideal reactor has control mechanisms in place to maintain $k=1$. Criticality is achieved when the number of neutrons inside a reactor increases with time. For a mixture of $^{235}U$ and $^{238}U$ isotopes in our reactor, let $F$ denote the fractional abundance of $^{235}U$, the total cross section for each isotope is
   $$\sigma_5 = \sigma_{f5} + \sigma_{c5}, \ \sigma_8 = \sigma_{f8} + \sigma_{c8}$$
   $$\sigma_{total} = F\sigma_{5} + (1-F)\sigma_{8}$$







* Slow neutron. In October, 1934, Fermi discovered accidentally that if the bombarding neutrons were caused to be slowed (“moderated”) before hitting the target element by having them first pass through water or paraffin, the rate of activity of the induced radioactivities could in some cases be drastically increased. Fermi attributed this to the neutrons having more time in the vicinity of target nuclei and hence a greater probability of reacting with them. 


## Flowchart

## More geometries

## Prompt
One way (of several possible) to achieve a self-sustaining nuclear chain reaction is to moderate fission neutrons originating in fuel rods so that the probability (cross section) of their producing further fissions is maximized. As discussed in class, materials such as graphite are ideal for this. Our goal is to estimate (for an approximate geometry) the optimal thickness of moderator that needs to be intercalated between fuel elements in a reactor pile for a self-sustaining chain reaction to take place: too little moderator will result in neutrons that are too “hard” (meaning “energetic”) to have a high chance of producing ensuing fission. Too much moderator will give them a chance to be lost by capture via 12C(nthermal,g)13C, rendering a self-sustaining reaction impossible. Finding the happy medium was one of the critical steps in building Chicago Pile No. 1 (CP-1) under the Stagg Field Stadium. Using the Monte Carlo method we can easily make a decision, the goal of this homework project (Mr. Fermi could have used your help –and that of an electronic computer-).

Using the attached flowchart and the subroutines provided and discussed in class, build a program that tracks neutrons emitted from a point-like fission source traveling into a graphite slab (infinite along x and y) of thickness D (see figure below). Plot the percentage of neutrons a) backscattered, b) absorbed, c) transmitted, d) transmitted with energies below ~500 eV (what we will consider here as optimal -or rather good enough- for producing further fissions), as a function of D, for 1 cm < D < 50 cm. Choose the optimal value of D (reason your choice). Plot the spectrum of exiting neutron energies for this choice of D, and compare it with the emission spectrum from the source. How well do you expect your recommendation to work for the more realistic situation of long fuel rods inserted in moderator? (Depicted in the figure on the right). Courageous students should not shy away from attempting a true 3D arrangement of rods. A simpler alternative approach is a single cell of a cubic lattice with a central uranium sphere, as described in class. Compare your answer (optimal D) with typical distances between uranium pellets in CP-1 (see “Physics of the Manhattan Project”, posted on Canvas).

Is there a better way to find this optimal thickness? Instead of neutrons transmitted or reflected with energy below 500 eV, tally the sum of the U235 fission cross sections (an obvious figure-of-merit proportional to the net probability for producing neutron-induced fission) for any transmitted or backscattered neutron. To do this you will need to read the file “u235fission.in” and load the data there into two large arrays (give yourself at least 32,000 elements per array), the first column containing neutron energy in MeV, the second U235 fission cross section in barns. Is the optimal D found in this way closer to what is used in real-life reactors? You can also try a tally composed of the sum of the products of neutron velocity times cross section, much closer to the actual reaction rate, as discussed in class. 

